<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Проверка авторизации
        function checkAuth() {
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                window.location.href = "home.html"; // Redirect if user is already logged in
            }
        }

        // Проверка логина
        function validateLogin(event) {
            event.preventDefault();

            const nicknameInput = document.getElementById("login-nickname").value;
            const passwordInput = document.getElementById("login-password").value;
            const rememberMe = document.getElementById("remember-me").checked;

            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.nickname === nicknameInput && u.password === passwordInput);

            if (user) {
                alert(`Добро пожаловать, ${nicknameInput}!`);

                // Если "Remember Me" включен, сохраняем пользователя и флаг в localStorage
                if (rememberMe) {
                    localStorage.setItem('currentUser', nicknameInput);
                    localStorage.setItem('rememberMe', 'true');
                } else {
                    localStorage.removeItem('currentUser');
                    localStorage.setItem('rememberMe', 'false');
                }

                window.location.href = "home.html";
            } else {
                alert("Неверный nickname или пароль.");
            }
        }

        // On page load, auto-fill nickname if "Remember Me" is selected
        window.onload = function() {
            checkAuth();
            const rememberMe = localStorage.getItem('rememberMe') === 'true';
            if (rememberMe) {
                const storedNickname = localStorage.getItem('currentUser');
                if (storedNickname) {
                    document.getElementById("login-nickname").value = storedNickname;
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-md">
        <h2 class="text-2xl font-bold mb-6 text-center">Login</h2>
        <form onsubmit="validateLogin(event)">
            <div class="mb-4">
                <label for="login-nickname" class="block text-gray-700 font-medium mb-2">Nickname</label>
                <input type="text" id="login-nickname" class="w-full px-3 py-2 border rounded-lg" required autocomplete="off">
            </div>
            <div class="mb-6">
                <label for="login-password" class="block text-gray-700 font-medium mb-2">Password</label>
                <input type="password" id="login-password" class="w-full px-3 py-2 border rounded-lg" required autocomplete="off">
            </div>
            <div class="mb-6 flex items-center">
                <input type="checkbox" id="remember-me" class="mr-2">
                <label for="remember-me" class="text-gray-700">Remember Me</label>
            </div>
            <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg">Login</button>
        </form>
        <p class="mt-6 text-center">Нет аккаунта? <a href="index.html" class="text-blue-600">Зарегистрироваться</a></p>
    </div>
</body>
</html>
